{"meta":{"title":"frogman","subtitle":"frogman","description":"frogman space","author":"Allen.S","url":"http://Frogman1s.github.io","root":"/"},"pages":[{"title":"","date":"2022-10-31T16:10:20.553Z","updated":"2022-10-31T16:10:20.553Z","comments":true,"path":"docs/index.html","permalink":"http://frogman1s.github.io/docs/index.html","excerpt":"","text":"2022.8.19å¹¿å·Â·å¤©æ²³ 2022Â·å¹¿å·å¡”"},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2022-10-30T13:28:00.427Z","updated":"2022-10-30T06:25:56.278Z","comments":true,"path":"categories/index.html","permalink":"http://frogman1s.github.io/categories/index.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿ğŸƒ","date":"2022-11-16T05:03:16.759Z","updated":"2022-11-16T05:03:16.759Z","comments":true,"path":"about/index.html","permalink":"http://frogman1s.github.io/about/index.html","excerpt":"","text":"ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸŒ±ğŸ¸æ¬¢è¿ç•™è¨€:é“è¡Œå°šæµ…çš„ç¨‹åºå‘˜ğŸ¦­ğŸƒğŸ»ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸ğŸƒğŸ»â€ï¸â€ï¸#çˆ±åƒé£Ÿç‰©çš„ç”·å­©å­ğŸ‘¦ #è‡ªå¾‹"},{"title":"å‹é“¾","date":"2022-10-30T13:28:00.439Z","updated":"2022-10-30T04:50:30.268Z","comments":true,"path":"friends/index.html","permalink":"http://frogman1s.github.io/friends/index.html","excerpt":"äººç”Ÿæœªæ˜“ç›¸é€¢æ˜¥æ½®å¸¦é›¨æ™šæ¥æ€¥,é‡æ¸¡æ— äººèˆŸè‡ªæ¨ª","text":"äººç”Ÿæœªæ˜“ç›¸é€¢æ˜¥æ½®å¸¦é›¨æ™šæ¥æ€¥,é‡æ¸¡æ— äººèˆŸè‡ªæ¨ª è¿™é‡Œå¯ä»¥å†™å‹é“¾é¡µé¢ä¸‹æ–¹çš„æ–‡å­—å¤‡æ³¨ï¼Œä¾‹å¦‚è‡ªå·±çš„å‹é“¾è§„èŒƒã€ç¤ºä¾‹ç­‰ã€‚å¦‚ä½•è‡ªåŠ©æ·»åŠ å‹é“¾ï¼Ÿå…ˆå‹åé“¾ï¼Œåœ¨æˆ‘ä»¬æœ‰ä¸€å®šäº†è§£äº†ä¹‹åæ‰å¯ä»¥äº¤æ¢å‹é“¾ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæ‚¨çš„ç½‘ç«™è¿˜åº”æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š åˆæ³•çš„ã€éè¥åˆ©æ€§ã€æ— å•†ä¸šå¹¿å‘Šæœ‰å®è´¨æ€§åŸåˆ›å†…å®¹çš„ HTTPS ç«™ç‚¹ç¬¬ä¸€æ­¥ï¼šæ–°å»º Issue æ–°å»º GitHub Issue æŒ‰ç…§æ¨¡æ¿æ ¼å¼å¡«å†™å¹¶æäº¤ã€‚ ä¸ºäº†æé«˜å›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼Œå»ºè®®ä¼˜åŒ–å¤´åƒï¼š æ‰“å¼€ å‹ç¼©å›¾ ä¸Šä¼ è‡ªå·±çš„å¤´åƒï¼Œå°†å›¾ç‰‡å°ºå¯¸è°ƒæ•´åˆ° 96px åä¸‹è½½ã€‚å°†å‹ç¼©åçš„å›¾ç‰‡ä¸Šä¼ åˆ° ImgURL å…è´¹å›¾åºŠ å¹¶ä½¿ç”¨æ­¤å›¾ç‰‡é“¾æ¥ä½œä¸ºå¤´åƒã€‚ç¬¬äºŒæ­¥ï¼šæ·»åŠ å‹é“¾å¹¶ç­‰å¾…ç®¡ç†å‘˜å®¡æ ¸ è¯·æ·»åŠ æœ¬ç«™åˆ°æ‚¨çš„å‹é“¾ä¸­ï¼Œå¦‚æœæ‚¨ä¹Ÿä½¿ç”¨ issue ä½œä¸ºå‹é“¾æºï¼Œåªéœ€è¦å‘ŠçŸ¥æ‚¨çš„å‹é“¾æºä»“åº“å³å¯ã€‚ æ‚¨å¯ä»¥æ·»åŠ æœ¬ç«™çš„ä»»ä½•ä¸€ä¸ªåŸŸï¼Œä¸‹é¢åªæ˜¯ä¸€ä¸ªä¾‹å­ã€‚ title: Frogman1savatar:https://avatars.githubusercontent.com/u/80079743?s=400&amp;u=2225e0312791a9b2b3eb15568e80f2138d14ee89&amp;v=4url: https://Frogman1s.github.iodescription: ã€ŒBe Yourself Make a Differenceã€keywords: æäº‹æƒ…ğŸ¤£å¾…ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡ï¼Œæ·»åŠ äº† active æ ‡ç­¾åï¼Œå›æ¥åˆ·æ–°å³å¯ç”Ÿæ•ˆã€‚"}],"posts":[{"title":"å¦‚ä½•è§£å†³å¹¶å‘åœºæ™¯ä¸‹æ‰£æ¬¾çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ","slug":"å¦‚ä½•è§£å†³å¹¶å‘åœºæ™¯ä¸‹æ‰£æ¬¾çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ","date":"2022-11-27T07:54:53.441Z","updated":"2022-11-27T08:45:11.541Z","comments":true,"path":"2022/11/27/å¦‚ä½•è§£å†³å¹¶å‘åœºæ™¯ä¸‹æ‰£æ¬¾çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ/","link":"","permalink":"http://frogman1s.github.io/2022/11/27/%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%B9%B6%E5%8F%91%E5%9C%BA%E6%99%AF%E4%B8%8B%E6%89%A3%E6%AC%BE%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98%EF%BC%9F/","excerpt":"","text":"1ã€åœºæ™¯ä»‹ç»åœºæ™¯1ï¼šæ‰£è´¹ï¼Œä¼ä¸šè´¦æˆ·é€æµé‡æˆ–è€…çº¢åŒ…ï¼Œç”¨æˆ·ç­¾åˆ°é¢†å–ã€‚æ­¤åœºæ™¯ä¸‹å°±æ˜¯å¤šç”¨æˆ·å¯¹æŸä¸€ä¸ªè´¦å·çš„å¹¶å‘æ‰£æ¬¾ï¼› åœºæ™¯2ï¼šå……å€¼ï¼Œæ‰“èµç»™ä¸»æ’­ï¼Œè¿™ç§åœºæ™¯æ˜¯å¤šç”¨æˆ·å¯¹åŒä¸€ä¸ªè´¦å·è¿›è¡Œæ‰“æ¬¾ï¼Œä½†æ˜¯æ–¹æ¡ˆå’Œé—®é¢˜å’Œåœºæ™¯1æ˜¯ä¸€è‡´çš„ã€‚ 2ã€åœºæ™¯ä¸¾ä¾‹å‡è®¾æœ‰ä¸¤ä¸ªä¸šåŠ¡æ“ä½œåŒä¸€ä¸ªè´¦å·ï¼Œè´¦å·ä½™é¢ä¸º100ï¼Œä¸šåŠ¡1æ‰£é™¤50ï¼Œä¸šåŠ¡2æ‰£é™¤40ï¼Œå¦‚æœé¡ºåˆ©åº”è¯¥æ˜¯å‰©ä½™100-50-40&#x3D;10ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹å¦‚ä¸‹å¹¶å‘æ“ä½œçš„åœºæ™¯ï¼š é€šè¿‡ä¸¤ä¸ªä¸šåŠ¡çš„å¹¶å‘æ“ä½œï¼Œæœ€åè´¦æˆ·ä½™é¢ä¸º60ï¼ˆæ˜¯ä¸šåŠ¡2æœ€åä¿®æ”¹åçš„ä½™é¢å€¼ï¼‰ã€‚ 3ã€è§£å†³æ–¹æ¡ˆ3.1 æ‚²è§‚é” æ¦‚å¿µ:è¦å¯¹æ•°æ®åº“ä¸­çš„ä¸€æ¡æ•°æ®è¿›è¡Œä¿®æ”¹çš„æ—¶å€™ï¼Œä¸ºäº†é¿å…åŒæ—¶è¢«å…¶ä»–äººä¿®æ”¹ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ç›´æ¥å¯¹è¯¥æ•°æ®è¿›è¡ŒåŠ é”ä»¥é˜²æ­¢å¹¶å‘ã€‚è¿™ç§å€ŸåŠ©æ•°æ®åº“é”æœºåˆ¶ï¼Œåœ¨ä¿®æ”¹æ•°æ®ä¹‹å‰å…ˆé”å®šï¼Œå†ä¿®æ”¹çš„æ–¹å¼è¢«ç§°ä¹‹ä¸ºæ‚²è§‚å¹¶å‘æ§åˆ¶ã€Pessimistic Concurrency Controlï¼Œç¼©å†™â€œPCCâ€ï¼Œåˆåâ€œæ‚²è§‚é”â€ã€‘ã€‚ æ‚²è§‚é”çš„å®ç° ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä½¿ç”¨è¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ã€è¡¨é”ã€è¯»é”ã€å†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨æ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚ Java é‡Œé¢çš„åŒæ­¥ synchronizedå…³é”®å­—çš„å®ç°ã€‚ æ‚²è§‚é”ä¸»è¦åˆ†ä¸ºå…±äº«é”å’Œæ’ä»–é” å…±äº«é”ã€shared locksã€‘åˆç§°ä¸ºè¯»é”ï¼Œç®€ç§° S é”ã€‚é¡¾åæ€ä¹‰ï¼Œå…±äº«é”å°±æ˜¯å¤šä¸ªäº‹åŠ¡å¯¹äºåŒä¸€æ•°æ®å¯ä»¥å…±äº«ä¸€æŠŠé”ï¼Œéƒ½èƒ½è®¿é—®åˆ°æ•°æ®ï¼Œä½†æ˜¯åªèƒ½è¯»ä¸èƒ½ä¿®æ”¹ã€‚ æ’ä»–é”ã€exclusive locksã€‘åˆç§°ä¸ºå†™é”ï¼Œç®€ç§° X é”ã€‚é¡¾åæ€ä¹‰ï¼Œæ’ä»–é”å°±æ˜¯ä¸èƒ½ä¸å…¶ä»–é”å¹¶å­˜ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡è·å–äº†ä¸€ä¸ªæ•°æ®è¡Œçš„æ’ä»–é”ï¼Œå…¶ä»–äº‹åŠ¡å°±ä¸èƒ½å†è·å–è¯¥è¡Œçš„å…¶ä»–é”ï¼ŒåŒ…æ‹¬å…±äº«é”å’Œæ’ä»–é”ã€‚è·å–æ’ä»–é”çš„äº‹åŠ¡å¯ä»¥å¯¹æ•°æ®è¡Œè¯»å–å’Œä¿®æ”¹ã€‚ åœ¨æŸ¥è¯¢è¯­å¥åŠ  for updateï¼Œè¡Œè®°å½•åŠ ä¸Šæ’å®ƒé”ï¼Œè¿™æ ·åæ¥çš„äº‹åŠ¡ä¼šé˜»å¡æŸ¥è¯¢ï¼Œè¿™æ ·å°±é¿å…äº†æ•°æ®ä¸ä¸€è‡´ã€‚ 12345678910111213//å¼€å§‹äº‹åŠ¡begin;//æ¶ˆè´¹é‡‘é¢$spend = 10;//æŸ¥è¯¢ç”¨æˆ·ä½™é¢$user = select id,money from t_account where id = #&#123;id&#125; for update;//è®¡ç®—é‡‘é¢$newMoney = $user[&#x27;money&#x27;]-$spend;//.. è¿™é‡Œæ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿ//æ›´æ–°ä½™é¢update t_account set money = $newMoney where id = #&#123;id&#125; ;//ç¡®è®¤æˆåŠŸä¹‹å æäº¤äº‹åŠ¡commit 3.2 ä¹è§‚é” æ¦‚å¿µä¹è§‚é”æ˜¯ç›¸å¯¹æ‚²è§‚é”è€Œè¨€çš„ï¼Œä¹è§‚é”å‡è®¾æ•°æ®ä¸€èˆ¬æƒ…å†µä¸ä¼šé€ æˆå†²çªï¼Œæ‰€ä»¥åœ¨æ•°æ®è¿›è¡Œæäº¤æ›´æ–°çš„æ—¶å€™ï¼Œæ‰ä¼šæ­£å¼å¯¹æ•°æ®çš„å†²çªä¸å¦è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå†²çªï¼Œåˆ™è¿”å›ç»™ç”¨æˆ·å¼‚å¸¸ä¿¡æ¯ï¼Œè®©ç”¨æˆ·å†³å®šå¦‚ä½•å»åšã€‚ä¹è§‚é”é€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œè¿™æ ·å¯ä»¥æé«˜ç¨‹åºçš„ååé‡ã€‚ ä¹è§‚é”é‡‡å–äº†æ›´åŠ å®½æ¾çš„åŠ é”æœºåˆ¶ã€‚ä¹Ÿæ˜¯ä¸ºäº†é¿å…æ•°æ®åº“å¹»è¯»ã€ä¸šåŠ¡å¤„ç†æ—¶é—´è¿‡é•¿ç­‰åŸå› å¼•èµ·æ•°æ®å¤„ç†é”™è¯¯çš„ä¸€ç§æœºåˆ¶ï¼Œä½†ä¹è§‚é”ä¸ä¼šåˆ»æ„ä½¿ç”¨æ•°æ®åº“æœ¬èº«çš„é”æœºåˆ¶ï¼Œè€Œæ˜¯ä¾æ®æ•°æ®æœ¬èº«æ¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€‚ä¹è§‚é”çš„å®ç°ï¼š CAS å®ç°ï¼šJava ä¸­java.util.concurrent.atomicåŒ…ä¸‹é¢çš„åŸå­å˜é‡ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§ CAS å®ç°æ–¹å¼ã€‚ ç‰ˆæœ¬å·æ§åˆ¶ï¼šä¸€èˆ¬æ˜¯åœ¨æ•°æ®è¡¨ä¸­åŠ ä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬å· version å­—æ®µï¼Œè¡¨ç¤ºæ•°æ®è¢«ä¿®æ”¹çš„æ¬¡æ•°ã€‚å½“æ•°æ®è¢«ä¿®æ”¹æ—¶ï¼Œversion å€¼ä¼š +1ã€‚å½“çº¿ç¨‹ A è¦æ›´æ–°æ•°æ®æ—¶ï¼Œåœ¨è¯»å–æ•°æ®çš„åŒæ—¶ä¹Ÿä¼šè¯»å– version å€¼ï¼Œåœ¨æäº¤æ›´æ–°æ—¶ï¼Œè‹¥åˆšæ‰è¯»å–åˆ°çš„ version å€¼ä¸å½“å‰æ•°æ®åº“ä¸­çš„ version å€¼ç›¸ç­‰æ—¶æ‰æ›´æ–°ï¼Œå¦åˆ™é‡è¯•æ›´æ–°æ“ä½œï¼Œç›´åˆ°æ›´æ–°æˆåŠŸã€‚ é€šè¿‡CASæ“ä½œï¼Œå³æ—§å€¼å’Œé¢„æœŸå€¼ç›¸åŒæ—¶æ‰§è¡Œä¿®æ”¹ï¼Œä¾‹å¦‚ï¼š update t_account set money=#&#123;new_money&#125; where id=#&#123;id&#125;; ä¿®æ”¹ä¸ºï¼š Update t_account set money=#&#123;new_money&#125; where id=#&#123;id&#125; and money=#&#123;old_money&#125;; è¿™æ ·åœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œåªèƒ½æœ‰ä¸€ä¸ªä¿®æ”¹æˆåŠŸï¼Œaffect rowä¸º1ï¼›å…¶ä»–äº‹åŠ¡ç”±äºmoneyä¸ç­‰äºæ—§å€¼ï¼Œä¿®æ”¹å¤±è´¥ï¼Œaffect rowä¸º0ã€‚ 3.3 ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å‡ç­‰äºçš„sqlæ“ä½œ ä¾‹å¦‚ : update t_account set money= money - $spend where id = #&#123;id&#125; ; è¿™é‡Œè¦å†åŠ ä¸Šä½™é¢çš„åˆ¤æ–­é¿å…å‡ºç°è´Ÿæ•°é‡‘é¢ï¼š Update t_account set money= money- $spend where id = #&#123;id&#125;&#125; and money&gt;= $spend ; ç¨å¾®æ”¹ä¸€ä¸‹è¿™é‡Œçš„æ›´æ–°è¯­å¥ä¹Ÿèƒ½å®Œæˆæ­£ç¡®çš„æ›´æ–°å°±ç®—æ˜¯å¹¶å‘ä¹Ÿéƒ½å°†æ­£å¸¸ã€‚ ä½†æ˜¯è¿™æ ·åšå°†äº§ç”Ÿä¸€ä¸ªé—®é¢˜ä¸å¹‚ç­‰ã€‚ ä»€ä¹ˆæ˜¯ä¸å¹‚ç­‰ ? åœ¨ç›¸åŒçš„æ¡ä»¶ä¸‹ï¼Œæ‰§è¡ŒåŒä¸€è¯·æ±‚ï¼Œå¾—åˆ°çš„ç»“æœç›¸åŒæ‰ç¬¦åˆå¹‚ç­‰æ€§ã€‚ å¦‚æœæ˜¯money&#x3D; money- $spendçš„æ“ä½œåœ¨å¤šæ¬¡æ“ä½œåœºæ™¯ä¸‹å°±ä¼šäº§ç”Ÿé‡å¤æ‰£æ¬¾ã€‚ 3.4 ABAé—®é¢˜ ABAé—®é¢˜æ˜¯ç”±CASè¡ç”Ÿæ¥çš„ï¼Œåœ¨å¹¶å‘æç«¯æƒ…å†µä¸‹ä¼šäº§ç”Ÿï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ABAé—®é¢˜ï¼Ÿ æ ‡å‡†çš„æè¿°å¦‚ä¸‹ï¼š å¹¶å‘1ï¼ˆä¸Šï¼‰ï¼šè·å–å‡ºæ•°æ®çš„åˆå§‹å€¼æ˜¯Aï¼Œåç»­è®¡åˆ’å®æ–½CASä¹è§‚é”ï¼ŒæœŸæœ›æ•°æ®ä»æ˜¯Açš„æ—¶å€™ï¼Œä¿®æ”¹æ‰èƒ½æˆåŠŸï¼› å¹¶å‘2ï¼šå°†æ•°æ®ä¿®æ”¹æˆBï¼› å¹¶å‘3ï¼šå°†æ•°æ®ä¿®æ”¹å›Aã€‚ å¹¶å‘1ï¼ˆä¸‹ï¼‰ï¼šCASä¹è§‚é”ï¼Œæ£€æµ‹å‘ç°åˆå§‹å€¼è¿˜æ˜¯Aï¼Œè¿›è¡Œæ•°æ®ä¿®æ”¹ã€‚ ä¸Šè¿°å¹¶å‘ç¯å¢ƒä¸‹ï¼Œå¹¶å‘1åœ¨ä¿®æ”¹æ•°æ®æ—¶ï¼Œè™½ç„¶è¿˜æ˜¯Aï¼Œä½†å·²ç»ä¸æ˜¯åˆå§‹æ¡ä»¶çš„Aäº†ï¼Œä¸­é—´å‘ç”Ÿäº†Aå˜Bï¼ŒBåˆå˜Açš„å˜åŒ–ï¼Œæ­¤Aå·²ç»éå½¼Aï¼Œæ•°æ®å´æˆåŠŸä¿®æ”¹ï¼Œå¯èƒ½å¯¼è‡´é”™è¯¯ï¼Œè¿™å°±æ˜¯CASå¼•å‘çš„æ‰€è°“çš„ABAé—®é¢˜ã€‚ ä¸¾ä¸€ä¸ªæ¸¸æˆå……å€¼ä¾‹å­ï¼Œå¦‚ä¸‹ï¼š æŒ‰ç…§ä¸šåŠ¡çš„è¯‰æ±‚ï¼Œäº‹åŠ¡3æ˜¯æœ€ç»ˆå°†æ•°æ®åº“ç»“æœå€¼æ¢å¤ä¸º100ï¼Œä½†æ˜¯é€šè¿‡casæ¯”è¾ƒæ›´æ–°æœ€ç»ˆç»“æœå‡ºç°äº†40ï¼Œè¿™ä¸ªå°±æ˜¯ABAå¯¼è‡´çš„é—®é¢˜ã€‚ æˆ‘ä»¬è¿˜æ˜¯ä»¥å‰é¢çš„sqlä½œä¸ºä¾‹å­è®²è§£ABAé—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ 1ã€æ•°æ®åº“è¡¨ç»“æ„ç”±(idã€money)ä¿®æ”¹ä¸º(idã€moneyã€version) 2ã€æ•°æ®åº“æŸ¥è¯¢ç”±ä¹‹å‰çš„ï¼š select money from t_account where id=#&#123;id&#125; ä¿®æ”¹ä¸ºï¼š select money,version from t_account where id=$&#123;id&#125; 3ã€æ•°æ®åº“ä¿®æ”¹é™¤äº†casæ¯”è¾ƒå¤–ï¼Œè¿˜éœ€è¦ç‰ˆæœ¬ç›¸åŒï¼Œå¹¶ä¸”è¿›è¡Œç‰ˆæœ¬ä¿®æ”¹ï¼š update t_account set money=#&#123;new_money&#125; where id=#&#123;id&#125; and money=#&#123;old_money&#125;; ä¿®æ”¹ä¸ºï¼š update t_account set money=#&#123;new_money&#125; where id=#&#123;id&#125; and money=#&#123;old_money&#125; and version=#&#123;version_old&#125; 4ã€æ€»ç»“select&amp;setä¸šåŠ¡åœºæ™¯ï¼Œåœ¨å¹¶å‘æ—¶ä¼šå‡ºç°ä¸€è‡´æ€§é—®é¢˜ï¼› åŸºäºâ€œå€¼â€çš„CASä¹è§‚é”ï¼Œå¯èƒ½å¯¼è‡´ABAé—®é¢˜ï¼› ä¸èƒ½é‡‡ç”¨å‡ç­‰äºçš„sqlæ“ä½œï¼Œç”±äºæ­¤æ“ä½œä¸å¹‚ç­‰ï¼› CASä¹è§‚é”ï¼Œå¿…é¡»ä¿è¯ä¿®æ”¹æ—¶çš„â€œæ­¤æ•°æ®â€å°±æ˜¯â€œå½¼æ•°æ®â€ï¼Œåº”è¯¥ç”±â€œå€¼â€æ¯”å¯¹ï¼Œä¼˜åŒ–ä¸ºâ€œç‰ˆæœ¬å·â€æ¯”å¯¹ã€‚","categories":[{"name":"java","slug":"java","permalink":"http://frogman1s.github.io/categories/java/"},{"name":"mysql","slug":"mysql","permalink":"http://frogman1s.github.io/categories/mysql/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","permalink":"http://frogman1s.github.io/categories/%E5%B9%B6%E5%8F%91/"}],"tags":[]},{"title":"ubuntuæœåŠ¡å™¨sshé…ç½®å¹¶å®Œæˆå†…ç½‘ç©¿é€","slug":"ubuntuæœåŠ¡å™¨sshé…ç½®å¹¶å®Œæˆå†…ç½‘ç©¿é€","date":"2022-11-01T03:46:59.420Z","updated":"2022-11-01T04:02:33.971Z","comments":true,"path":"2022/11/01/ubuntuæœåŠ¡å™¨sshé…ç½®å¹¶å®Œæˆå†…ç½‘ç©¿é€/","link":"","permalink":"http://frogman1s.github.io/2022/11/01/ubuntu%E6%9C%8D%E5%8A%A1%E5%99%A8ssh%E9%85%8D%E7%BD%AE%E5%B9%B6%E5%AE%8C%E6%88%90%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","excerpt":"","text":"ubuntuæœåŠ¡å™¨sshé…ç½®å¹¶å®Œæˆå†…ç½‘ç©¿é€åŸºæœ¬ä»‹ç»:ç‰©ç†æœåŠ¡å™¨å·²ç»å®‰è£…ubuntu18.04.éœ€è¦é…ç½®sshå®ç°å†…ç½‘ç™»å½•,å¹¶ä¸”ä½¿ç”¨å†…ç½‘ç©¿é€å®ç°å…¬ç½‘è¿œç¨‹è®¿é—®. æ³¨æ„:å¦‚æœä½ åªæ˜¯æƒ³ç™»é™†åˆ«çš„æœºå™¨çš„SSHåªéœ€è¦å®‰è£…openssh-client(ubuntuæœ‰é»˜è®¤å®‰è£…ï¼Œå¦‚æœæ²¡æœ‰åˆ™sudo apt-get install openssh-client)ï¼Œå¦‚æœè¦ä½¿æœ¬æœºå¼€æ”¾SSHæœåŠ¡å°±éœ€è¦å®‰è£…openssh-server ä¸€ã€é…ç½®sshå®ç°å†…ç½‘ç™»å½•:1.å®‰è£…ssh-server:1sudo apt-get install openssh-server 2.å¯åŠ¨sshæœåŠ¡:1sudo /etc/init.d/ssh startæˆ–sudo service ssh start 3.è®¾ç½®å…è®¸è¿œç¨‹rootç”¨æˆ·ç™»å½•:1sudo vim /etc/ssh/sshd_config æœç´¢æ‰¾åˆ°PermitRootLogin åŠ å…¥é…ç½® PermitRootLogin yes 4.é‡å¯SSHæœåŠ¡ï¼š12sudo /etc/init.d/ssh stopsudo /etc/init.d/ssh start 5.ç™»é™†SSHåŒä¸€å±€åŸŸç½‘å†…å…¶ä»–æœºå™¨å¯ä»¥è¾“å…¥å‘½ä»¤å®ç°è®¿é—®,å†…ç½‘è®¿é—® ssh æœåŠ¡å™¨åå­—@å†…ç½‘ipæ³¨æ„:ä¸çŸ¥é“æœåŠ¡å™¨IPåœ°å€å¯è¾“å…¥ifconfigæŸ¥çœ‹,å¦‚æœæ‰¾ä¸åˆ°å‘½ä»¤è¯·å…ˆè¾“å…¥ 1sudo apt install net-tools å®‰è£…net-tools. äºŒã€å†…ç½‘ç©¿é€,å®ç°å…¬ç½‘è®¿é—®ä»‹ç»:ä¸Šè¿°æ–¹å¼å·²ç»å®ç°åŒä¸€å±€åŸŸç½‘å†…å¯¹ubuntuæœåŠ¡å™¨çš„è®¿é—®,å®¢æˆ·ç«¯ä¸€æ—¦ç¦»å¼€è¯¥å±€åŸŸç½‘å°±ä¼šå¤±å»è¿æ¥,å¦‚æœæƒ³è¦å®ç°åœ¨å®¶é‡Œ,å’–å•¡å…æˆ–è€…å…¶ä»–åœ°æ–¹éšæ—¶éšåœ°å¯¹æœåŠ¡å™¨è®¿é—®è¯¥æ€ä¹ˆåŠå‘¢?åœ¨ipv4å…¬ç½‘IPèµ„æºæ¯ç«­çš„æƒ…å†µä¸‹ï¼Œè¿è¥å•†åŸºæœ¬ä¸ä¼šåˆ†é…å…¬ç½‘IPã€‚è€Œæƒ³è¦å®ç°å…¬ç½‘è®¿é—®å†…ç½‘&#x2F;å±€åŸŸç½‘ï¼Œæ™®éæ˜¯é€šè¿‡å†…ç½‘ç©¿é€æ¥å®ç°ã€‚æœ¬æ–‡ä½¿ç”¨cpolarå®Œæˆå†…ç½‘ç©¿é€ï¼Œæ”¯æŒhttp&#x2F;https&#x2F;tcpåè®®ï¼Œå¯å…è´¹ä½¿ç”¨ï¼Œå¹¶ä¸”ä¸é™åˆ¶æµé‡ã€‚èƒ½å¤Ÿå°†æœ¬åœ°ç«¯å£æ˜ å°„åˆ°å…¬ç½‘ä¸Šï¼Œç”Ÿæˆå…¬ç½‘ï¼Œå®ç°å¤–ç½‘ä»»æ„åœ°ç‚¹è¿œç¨‹è®¿é—®å†…ç½‘ã€‚ 1.å®‰è£…cpolar1curl -L https://www.cpolar.com/static/downloads/install-release-cpolar.sh | sudo bash æ³¨æ„:å¦‚æœæ²¡æœ‰curlè¯·æŒ‰ç…§æç¤ºå®‰è£…curl 2.æŸ¥çœ‹cpolarç‰ˆæœ¬ä¿¡æ¯1cpolar version 3.æ³¨å†Œç™»å½•cpolarè·å–Authtokenå¤åˆ¶ä½ çš„token 1cpolar authtoken xxxxxxx(ä½ çš„token) 4.å‘ç³»ç»Ÿæ·»åŠ æœåŠ¡1sudo systemctl enable cpolar 5.å¯åŠ¨cpolaræœåŠ¡1sudo systemctl start cpolar 6.æŸ¥çœ‹æœåŠ¡çŠ¶æ€1sudo systemctl status cpolar 7.å¼€å¯ç©¿é€è¦åœ¨ç«¯å£80ä¸Šå¯åŠ¨HTTPéš§é“ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1cpolar http 80 8.è·å–sshéš§é“çš„å…¬ç½‘åœ°å€ç™»å½•cpolar web UIç®¡ç†ç•Œé¢ åœ¨æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:9200/ï¼Œè¾“å…¥æ‰€æ³¨å†Œçš„cpolarè´¦å·å¯†ç ï¼Œç™»å½•cpolar web UIç®¡ç†ç•Œé¢ æ§åˆ¶ç«¯ç”µè„‘æ‰“å¼€ç»ˆç«¯å‘½ä»¤è¡Œï¼Œè¾“å…¥å‘½ä»¤ï¼Œè¿œç¨‹sshè®¿é—®å±€åŸŸç½‘å†…çš„ubuntuã€‚ å¦‚cpolarå·²ç»å°†æœ¬åœ°22ç«¯å£æ˜ å°„åˆ°äº†xxxxç«¯å£ï¼Œæ‰€ä»¥ï¼Œsshå‘½ä»¤éœ€è¦åŠ -på‚æ•°ï¼Œåé¢åŠ å…¬ç½‘éš§é“ç«¯å£å·(å…·ä½“ç«¯å£å·åœ¨urlçš„:åé¢) 1ssh -p XXXXX ç”¨æˆ·å@1.tcp.vip.cpolar.cnï¼ˆXä¸ºcpolarç”Ÿæˆçš„ç«¯å£å·ï¼Œç”¨æˆ·åæ›¿æ¢ä¸ºä¸»æœºç”¨æˆ·åï¼‰ åœ¨è¾“å…¥æ­£ç¡®çš„å‘½ä»¤åï¼ŒUbuntuä¼šå‡ºç°æç¤ºä¿¡æ¯ï¼Œè¯¢é—®æ˜¯å¦ç¡®å®šè¿æ¥è¯¥ç«¯å£ï¼Œå¹¶è¦æ±‚è¾“å…¥Ubuntuç³»ç»Ÿçš„å¯†ç ï¼Œæ­¤æ—¶åˆ†åˆ«è¾“å…¥â€œyesâ€å’Œubuntç³»ç»Ÿå¯†ç å³å¯ã€‚ æ³¨æ„:cpolarå…è´¹ç‰ˆ24å°æ—¶æ›´æ–°ä¸€æ¬¡å…¬ç½‘ip,è®°å¾—ä¿®æ”¹å‘½ä»¤é‡Œçš„ipå‚æ•°.è¯¦æƒ…è§æ–‡æ¡£","categories":[{"name":"linux","slug":"linux","permalink":"http://frogman1s.github.io/categories/linux/"},{"name":"ssh","slug":"linux/ssh","permalink":"http://frogman1s.github.io/categories/linux/ssh/"},{"name":"cploar","slug":"cploar","permalink":"http://frogman1s.github.io/categories/cploar/"}],"tags":[]},{"title":"Swagger2å…¥é—¨","slug":"Swagger2","date":"2022-10-30T08:01:12.324Z","updated":"2022-10-30T08:01:12.324Z","comments":true,"path":"2022/10/30/Swagger2/","link":"","permalink":"http://frogman1s.github.io/2022/10/30/Swagger2/","excerpt":"","text":"4. Swagger2 4.1 ç®€ä»‹Swagger æ˜¯ä¸€å¥—åŸºäº OpenAPI è§„èŒƒæ„å»ºçš„å¼€æºå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è®¾è®¡ã€æ„å»ºã€è®°å½•ä»¥åŠä½¿ç”¨ Rest APIã€‚ 4.2 ä¸ºä»€ä¹ˆä½¿ç”¨Swaggerå½“ä¸‹å¾ˆå¤šå…¬å¸éƒ½é‡‡å–å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ï¼Œå‰ç«¯å’Œåç«¯çš„å·¥ä½œç”±ä¸åŒçš„å·¥ç¨‹å¸ˆå®Œæˆã€‚åœ¨è¿™ç§å¼€å‘æ¨¡å¼ä¸‹ï¼Œ ç»´æŒä¸€ä»½åŠæ—¶æ›´æ–°ä¸”å®Œæ•´çš„ Rest API æ–‡æ¡£å°†ä¼šæå¤§çš„æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚ ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æ–‡æ¡£éƒ½æ˜¯åç«¯å¼€å‘äººå‘˜æ‰‹åŠ¨ç¼–å†™çš„ï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿéƒ½çŸ¥é“è¿™ç§æ–¹å¼å¾ˆéš¾ä¿è¯æ–‡æ¡£çš„åŠæ—¶æ€§ï¼Œ è¿™ç§æ–‡æ¡£ä¹…è€Œä¹…ä¹‹ä¹Ÿå°±ä¼šå¤±å»å…¶å‚è€ƒæ„ä¹‰ï¼Œåè€Œè¿˜ä¼šåŠ å¤§æˆ‘ä»¬çš„æ²Ÿé€šæˆæœ¬ã€‚ è€Œ Swagger ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¨æ–°çš„ç»´æŠ¤ API æ–‡æ¡£çš„æ–¹å¼ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹å®ƒçš„ä¼˜ç‚¹ï¼š 1.ä»£ç å˜ï¼Œæ–‡æ¡£å˜ã€‚åªéœ€è¦å°‘é‡çš„æ³¨è§£ï¼ŒSwagger å°±å¯ä»¥æ ¹æ®ä»£ç è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼Œå¾ˆå¥½çš„ä¿è¯äº†æ–‡æ¡£çš„æ—¶æ•ˆæ€§ã€‚2.è·¨è¯­è¨€æ€§ï¼Œæ”¯æŒ 40 å¤šç§è¯­è¨€ã€‚3.Swagger UI å‘ˆç°å‡ºæ¥çš„æ˜¯ä¸€ä»½å¯äº¤äº’å¼çš„ API æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ–‡æ¡£é¡µé¢å°è¯• API çš„è°ƒç”¨ï¼Œçœå»äº†å‡†å¤‡å¤æ‚çš„è°ƒç”¨å‚æ•°çš„è¿‡ç¨‹ã€‚ 4.3 å¿«é€Ÿå…¥é—¨4.3.1 å¼•å…¥ä¾èµ–123456789&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;&lt;/dependency&gt; 4.3.2 å¯ç”¨Swagger2åœ¨å¯åŠ¨ç±»ä¸Šæˆ–è€…é…ç½®ç±»åŠ  @EnableSwagger2 æ³¨è§£ 123456789@SpringBootApplication@MapperScan(&quot;com.sangeng.mapper&quot;)@EnableScheduling@EnableSwagger2public class SanGengBlogApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(SanGengBlogApplication.class,args); &#125;&#125; 4.3.3 æµ‹è¯•è®¿é—®ï¼šhttp://localhost:7777/swagger-ui.html æ³¨æ„å…¶ä¸­localhostå’Œ7777è¦è°ƒæ•´æˆå®é™…é¡¹ç›®çš„åŸŸåå’Œç«¯å£å·ã€‚ 4.4 å…·ä½“é…ç½®4.4.1 Controlleré…ç½®4.4.1 @Api æ³¨è§£å±æ€§ä»‹ç»ï¼š tags è®¾ç½®æ ‡ç­¾ description è®¾ç½®æè¿°ä¿¡æ¯ 12345@RestController@RequestMapping(&quot;/comment&quot;)@Api(tags = &quot;è¯„è®º&quot;,description = &quot;è¯„è®ºç›¸å…³æ¥å£&quot;)public class CommentController &#123;&#125; 4.4.2 æ¥å£é…ç½®4.4.2.1 æ¥å£æè¿°é…ç½®@ApiOperation12345@GetMapping(&quot;/linkCommentList&quot;)@ApiOperation(value = &quot;å‹é“¾è¯„è®ºåˆ—è¡¨&quot;,notes = &quot;è·å–ä¸€é¡µå‹é“¾è¯„è®º&quot;)public ResponseResult linkCommentList(Integer pageNum,Integer pageSize)&#123; return commentService.commentList(SystemConstants.LINK_COMMENT,null,pageNum,pageSize);&#125; 4.4.2.2 æ¥å£å‚æ•°æè¿° @ApiImplicitParam ç”¨äºæè¿°æ¥å£çš„å‚æ•°ï¼Œä½†æ˜¯ä¸€ä¸ªæ¥å£å¯èƒ½æœ‰å¤šä¸ªå‚æ•°ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ @ApiImplicitParams ç»„åˆä½¿ç”¨ã€‚ 12345678910@GetMapping(&quot;/linkCommentList&quot;)@ApiOperation(value = &quot;å‹é“¾è¯„è®ºåˆ—è¡¨&quot;,notes = &quot;è·å–ä¸€é¡µå‹é“¾è¯„è®º&quot;)@ApiImplicitParams(&#123; @ApiImplicitParam(name = &quot;pageNum&quot;,value = &quot;é¡µå·&quot;), @ApiImplicitParam(name = &quot;pageSize&quot;,value = &quot;æ¯é¡µå¤§å°&quot;)&#125;)public ResponseResult linkCommentList(Integer pageNum,Integer pageSize)&#123; return commentService.commentList(SystemConstants.LINK_COMMENT,null,pageNum,pageSize);&#125; 4.4.3 å®ä½“ç±»é…ç½®4.4.3.1 å®ä½“çš„æè¿°é…ç½®@ApiModel@ApiModelç”¨äºæè¿°å®ä½“ç±»ã€‚ 1234567@Data@AllArgsConstructor@NoArgsConstructor@ApiModel(description = &quot;æ·»åŠ è¯„è®ºdto&quot;)public class AddCommentDto&#123; //..&#125; 4.4.3.2 å®ä½“çš„å±æ€§çš„æè¿°é…ç½®@ApiModelProperty@ApiModelPropertyç”¨äºæè¿°å®ä½“çš„å±æ€§ 12@ApiModelProperty(notes = &quot;è¯„è®ºç±»å‹ï¼ˆ0ä»£è¡¨æ–‡ç« è¯„è®ºï¼Œ1ä»£è¡¨å‹é“¾è¯„è®ºï¼‰&quot;)private String type; 4.4.4 æ–‡æ¡£ä¿¡æ¯é…ç½®123456789101112131415161718192021@Configurationpublic class SwaggerConfig &#123; @Bean public Docket customDocket() &#123; return new Docket(DocumentationType.SWAGGER_2) .apiInfo(apiInfo()) .select() .apis(RequestHandlerSelectors.basePackage(&quot;com.sangeng.controller&quot;)) .build(); &#125; private ApiInfo apiInfo() &#123; Contact contact = new Contact(&quot;å›¢é˜Ÿå&quot;, &quot;http://www.my.com&quot;, &quot;my@my.com&quot;); return new ApiInfoBuilder() .title(&quot;æ–‡æ¡£æ ‡é¢˜&quot;) .description(&quot;æ–‡æ¡£æè¿°&quot;) .contact(contact) // è”ç³»æ–¹å¼ .version(&quot;1.1.0&quot;) // ç‰ˆæœ¬ .build(); &#125;&#125;","categories":[{"name":"java","slug":"java","permalink":"http://frogman1s.github.io/categories/java/"},{"name":"æµ‹è¯•","slug":"æµ‹è¯•","permalink":"http://frogman1s.github.io/categories/%E6%B5%8B%E8%AF%95/"}],"tags":[]}],"categories":[{"name":"java","slug":"java","permalink":"http://frogman1s.github.io/categories/java/"},{"name":"mysql","slug":"mysql","permalink":"http://frogman1s.github.io/categories/mysql/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","permalink":"http://frogman1s.github.io/categories/%E5%B9%B6%E5%8F%91/"},{"name":"linux","slug":"linux","permalink":"http://frogman1s.github.io/categories/linux/"},{"name":"ssh","slug":"linux/ssh","permalink":"http://frogman1s.github.io/categories/linux/ssh/"},{"name":"cploar","slug":"cploar","permalink":"http://frogman1s.github.io/categories/cploar/"},{"name":"æµ‹è¯•","slug":"æµ‹è¯•","permalink":"http://frogman1s.github.io/categories/%E6%B5%8B%E8%AF%95/"}],"tags":[]}